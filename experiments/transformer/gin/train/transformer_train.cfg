import experiments.graph.data_loader
import experiments.graph.dataset

### experiment setup ###
experiment.model = @HFPerceiver
experiment.criterion = @PerceiverFocalLoss
experiment.metrics = [
    @transformer.precision,
    @transformer.recall,
    @transformer.f1_score,
    @transformer.true_acc,
    @transformer.fake_acc
]
experiment.optimizer = @AdamW
experiment.data_loader = @CloudDataLoader
experiment.epochs = 100
experiment.fp16_training = False
experiment.random_seed = 42
experiment.num_gpus = 0


CloudDataLoader.dataset = @CloudDataset
CloudDataLoader.collate_fn = @cloud_collate_fn
CloudDataLoader.n_train = 8000
CloudDataLoader.n_valid = 2000
CloudDataLoader.batch_size = 8
# dataset
CloudDataset.input_dir = "D:\data\spd\cloud_3"
CloudDataset.n_samples = 10000

### model ###
Performer.n_feat = 3
HFPerceiver.d_latents = 128
### loss ###
PerceiverFocalLoss.alpha = 0.2   # 0.5 / 0.1
PerceiverFocalLoss.gamma = 2   # 0.5 / 0.1
### optimizer ###
AdamW.lr = 0.00001
# AdamW.weight_decay = 0.000001
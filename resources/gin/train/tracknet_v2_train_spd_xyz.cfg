### experiment setup ###
experiment.model = @TrackNETv2
experiment.criterion = @TrackNetLossXYZ
experiment.metrics = [@ellipse_area_xyz, @efficiency_xyz]
experiment.optimizer = @Adam
experiment.data_loader = @TrackNetV2DataLoader
experiment.epochs = 500
experiment.fp16_training = False
experiment.random_seed = 321
experiment.clip_grads = True
experiment.num_gpus = 1
#experiment.auto_lr_find = True
#experiment.resume_from_checkpoint = 'lightning_logs/TrackNETv2/version_46'

### model ###
TrackNETv2.input_features = 3
TrackNETv2.conv_features = 32
TrackNETv2.output_features = 3
TrackNETv2.rnn_type = 'gru'
TrackNETv2.batch_first = True
TrackNETv2.use_causalconv=False
TrackNETv2.use_rnn=True

### data ###
TrackNetV2DataLoader.batch_size = 4096
TrackNetV2DataLoader.dataset = @ariadne.tracknet_v2.dataset.TrackNetV2DatasetWithMask
TrackNetV2DataLoader.max_size = None
TrackNetV2DataLoader.valid_size = 0.2
TrackNetV2DataLoader.collate_fn = @tracknetv2_collate_fn

# dataset

ariadne.tracknet_v2.dataset.TrackNetV2DatasetWithMask.input_features = 3
ariadne.tracknet_v2.dataset.TrackNetV2DatasetWithMask.data_path = '/zfs/store5.hydra.local/user/d/drusov/ariadne_spd/ariadne/output/spd_tracknet_normalized_unbalanced_1250_xyz/masked_tracknet_spd_all_stations.npy'

### loss ###
TrackNetLossXYZ.alpha = 0.001

### optimizer ###
Adam.lr = 0.001
